<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hitung Total Berat</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; padding: 16px; }
    .wrap { max-width: 980px; }

    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    thead th { background: #f6f6f6; }

    input[type="number"] { width: 100%; box-sizing: border-box; padding: 6px; }

    .row { margin-top: 12px; display: grid; gap: 8px; max-width: 420px; }
    .out { margin-top: 12px; max-width: 420px; padding: 10px; border: 1px solid #ddd; }
    .label { font-weight: 600; }
  </style>
</head>
<body>
  <div class="wrap">
    <table id="tbl">
      <thead>
        <tr>
          <th>No</th>
          <th>Kolom 1</th>
          <th>Kolom 2</th>
          <th>Kolom 3</th>
          <th>Kolom 4</th>
          <th>Kolom 5</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>

    <div class="row">
      <label class="label" for="totalEkor">Total ekor</label>
      <input id="totalEkor" type="number" min="0" step="1" inputmode="numeric" placeholder="Misal: 20" />
    </div>

    <div class="out">
      <div><span class="label">Total berat:</span> <span id="totalBerat">0.0</span></div>
      <div><span class="label">Berat bersih:</span> <span id="beratBersih">0.0</span></div>
    </div>
  </div>

  <script>
    const ROWS = 20;
    const COLS = 5;

    const tbody = document.getElementById('tbody');
    const totalEkorEl = document.getElementById('totalEkor');
    const totalBeratEl = document.getElementById('totalBerat');
    const beratBersihEl = document.getElementById('beratBersih');

    // Buat tabel 20 baris x 5 kolom input (+ 1 kolom nomor)
    for (let r = 0; r < ROWS; r++) {
      const tr = document.createElement('tr');

      const tdNo = document.createElement('td');
      tdNo.textContent = String(r + 1);
      tr.appendChild(tdNo);

      for (let c = 0; c < COLS; c++) {
        const td = document.createElement('td');
        const inp = document.createElement('input');

        inp.type = 'number';
        inp.step = '0.1';     // 1 angka di belakang koma
        inp.min = '0';
        inp.inputMode = 'decimal';
        inp.placeholder = '0.0';
        inp.className = 'w';

        inp.addEventListener('input', hitung);

        // Rapikan ke 1 desimal saat selesai input
        inp.addEventListener('blur', () => {
          const v = parseFloat(inp.value);
          if (!Number.isFinite(v)) { inp.value = ''; hitung(); return; }
          const oneDecimal = Math.round(v * 10) / 10;
          inp.value = oneDecimal.toFixed(1);
          hitung();
        });

        td.appendChild(inp);
        tr.appendChild(td);
      }

      tbody.appendChild(tr);
    }

    totalEkorEl.addEventListener('input', hitung);

    function hitung() {
      const inputs = document.querySelectorAll('#tbl input.w');
      let total = 0;

      inputs.forEach(el => {
        const v = parseFloat(el.value);
        if (Number.isFinite(v)) total += v;
      });

      const ekor = parseInt(totalEkorEl.value, 10);
      const bersih = (Number.isFinite(ekor) && ekor > 0) ? (total / ekor) : 0;

      totalBeratEl.textContent = total.toFixed(1);
      beratBersihEl.textContent = bersih.toFixed(1);
    }

    hitung();
  </script>
</body>
</html>
